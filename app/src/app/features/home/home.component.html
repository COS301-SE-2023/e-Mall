<app-navbar></app-navbar>
<ion-content class="global-ion-content">
  <div class="ion-content-wrapper">
    <div class="row1">
      <div class="side-pannel">
        <ion-img id="logo" src="assets/images/logo.png" alt="E-Mall"></ion-img>

        <h3 class="welcome-footer">
          Discover<br />Compare<br />Shop<br />E-Mall Has It All!
        </h3>
        <ion-button class="overlay-button" (click)="onAboutClick()">
          More About Us
        </ion-button>
      </div>

      <div class="cat-container">
        <div class="cat-title">
          <h2>Browse by Category</h2>
        </div>
        <div class="bubble-container">
          <div
            *ngFor="let page of cat_pages"
            class="category-bubble"
            (click)="onCatClicked(page.path)">
            {{ page.title }}
          </div>
        </div>
      </div>
    </div>

    <br /><br />
    <!--Product carousel-->
    <!-- <div style="align-items: center" *ngIf="(forYouProducts$ | async) !== null"> -->
    <div style="align-items: center" *ngIf="(forYouProducts$ | async) !== null">
      <h3 #recommendedHeading>Recommended For You</h3>
    </div>

    <div
      style="
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      ">
      <div
        class="carousel-container"
        *ngIf="(forYouProducts$ | async) !== null">
        <ngb-carousel
          *ngIf="forYouProducts$ | async as products"
          [interval]="0"
          [animation]="true"
          [showNavigationArrows]="products.length >= 2"
          [showNavigationIndicators]="products.length >= 2"
          [wrap]="true"
          class="custom-carousel carousel-dark">
          <ng-template ngbSlide *ngIf="products[0]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(0, 4); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
          <ng-template ngbSlide *ngIf="products[4]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(4, 8); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
          <ng-template ngbSlide *ngIf="products[8]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(8, 12); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
        </ngb-carousel>
      </div>
    </div>

    <br /><br />
    <div style="align-items: center">
      <h3>Trending products</h3>
    </div>
    <div
      style="
        width: 100%;
        display: flex;
        justify-content: center;
        align-items: center;
      ">
      <div
        class="carousel-container"
        *ngIf="trendingProducts$ | async as products; else loading">
        <ngb-carousel
          [interval]="0"
          [animation]="true"
          [showNavigationArrows]="true"
          [showNavigationIndicators]="true"
          [wrap]="true"
          class="custom-carousel carousel-dark">
          <!-- <ng-template ngbSlide *ngIf="products[0]"> -->
          <ng-template ngbSlide *ngIf="products[0]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(0, 4); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
          <ng-template ngbSlide *ngIf="products[4]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(4, 8); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
          <ng-template ngbSlide *ngIf="products[8]">
            <div class="row">
              <div
                class="product-card"
                *ngFor="let product of products.slice(8, 12); let i = index">
                <app-product-card
                  [product]="product"
                  [pageType]="'normal'"></app-product-card>
              </div>
            </div>
          </ng-template>
        </ngb-carousel>
      </div>
    </div>
    <br /><br />
    <div class="register-row">
      <div class="register-container">
        <div class="register-title">
          <h2 class="welcome-footer">
            Have a small local business?<br />
            Register it on E-Mall today!
          </h2>
        </div>
        <div class="register-btn">
          <ion-button class="overlay-button" (click)="onRegClick()">
            Register
          </ion-button>
        </div>
      </div>
    </div>
  </div>
  <br /><br />

  <ng-container *ngIf="followedSellers$ | async as sellers">
    <ng-container *ngIf="sellers !== null && sellers.length !== 0">
      <div
        style="
          display: flex;
          justify-content: center;
          align-items: center;
          flex-direction: column;
        ">
        <div style="align-items: center">
          <h3>Followed Sellers</h3>
        </div>
        <div
          style="
            width: 60%;
            height: 200px;
            display: flex;
            justify-content: center;
            align-items: center;
          ">
          <swiper-container
            [centerInsufficientSlides]="true"
            [slidesPerView]="3"
            [loop]="true"
            [lazy]="true">
            <swiper-slide *ngFor="let seller of sellers">
              <ion-img
                style="width: 100%; max-width: 200px; height: 100px"
                (click)="redirect(seller.id)"
                [src]="seller.logo"
                [alt]="seller.name"></ion-img>
            </swiper-slide>
          </swiper-container>
        </div>
      </div>
      <br /><br />
    </ng-container>
  </ng-container>

  <app-footer></app-footer>
</ion-content>

<ng-template #loading>
  <div class="carousel-container">
    <ngb-carousel
      [interval]="0"
      [animation]="true"
      [showNavigationArrows]="false"
      [showNavigationIndicators]="false"
      [wrap]="true"
      class="custom-carousel carousel-dark">
      <!-- <ng-template ngbSlide *ngIf="products[0]"> -->
      <ng-template ngbSlide>
        <div class="row">
          <div class="product-card" *ngFor="let number of [0, 1, 2, 3]">
            <app-product-card-placeholder></app-product-card-placeholder>
          </div>
        </div>
      </ng-template>
    </ngb-carousel>
  </div>
</ng-template>
